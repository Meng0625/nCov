yy.s = c(4.33,4.33,0,-4.33,-4.33,0)
cc.list = samples_orderd
par(mar=c(0,0,2,0),mfrow=c(3,5))
for(cc in cc.list){
# tmp.CW.mat=CW.mat[which(cancer.types[rownames(CW.mat)]==cc),]
plot(0,0,xlim=c(-6,6),ylim=c(-6,6),axes=F,xlab='',ylab='',cex=0,asp=1,main=cc,cex.main=1.5)
rr.s=c()
sub_table = subset(data, sample == cc)
for(ii in 1:length(gg.list)){
gg1=gg.list[ii] #获得了这个IGHC
# n.gg1=length(which(tmp.CW.mat[,gg1]==1))/10
# rr.s=c(rr.s,log10(n.gg1))
for(jj in ii:length(gg.list)){
if(jj==ii)next
gg2=gg.list[jj]
from = min(gg1, gg2)
to = max(gg1, gg2)
rec =  sub_table[which(sub_table$from==from & sub_table$to ==to),]
if (nrow(rec) != 1){
print("ERROR")
next
}
h = rec$weight
if (rec$qValue< 0.05) {col=col=rgb(240,46,46,alpha=100,max=255)} else {col=col=rgb(50,50,50,alpha=10,max=255)}
segments(xx.s[ii],yy.s[ii],xx.s[jj],yy.s[jj],lwd=h,col=col)
}
}
for (count in 1:6){
draw.circle(xx.s[count],yy.s[count],2,col = Ig.cols[count])
}
#text(xx.s,yy.s,gg.list,font=2)
}
setwd("C:/Users/Meng/Desktop/nCov/bCellfNet/")
data = read.csv("./outs/cs_network.csv")
library(plotrix)
data$weight = log2(data$weight+1)
Ig.cols = c("#E64B35", "#4DBBD5", "#00A087", "#3C5488", "#F39B7F", "#8491B4")
samples_without_bacterial = c("S4","S7","S12","S14","S16")
samples_with_bacterial = setdiff(as.vector(unique(data$sample)),c("S4","S7","S12","S14","S16"))
samples_orderd = c(samples_with_bacterial,samples_without_bacterial)
gg.list=c('IGHG1', 'IGHA1', 'IGHM', 'IGHG3', 'IGHG2','IGHA2')
# 六个点的横纵坐标
xx.s = c(-2.5,2.5,5,2.5,-2.5,-5)
yy.s = c(4.33,4.33,0,-4.33,-4.33,0)
cc.list = samples_orderd
par(mar=c(0,0,2,0),mfrow=c(3,5))
for(cc in cc.list){
# tmp.CW.mat=CW.mat[which(cancer.types[rownames(CW.mat)]==cc),]
plot(0,0,xlim=c(-6,6),ylim=c(-6,6),axes=F,xlab='',ylab='',cex=0,asp=1,main=cc,cex.main=1.5)
rr.s=c()
sub_table = subset(data, sample == cc)
for(ii in 1:length(gg.list)){
gg1=gg.list[ii] #获得了这个IGHC
# n.gg1=length(which(tmp.CW.mat[,gg1]==1))/10
# rr.s=c(rr.s,log10(n.gg1))
for(jj in ii:length(gg.list)){
if(jj==ii)next
gg2=gg.list[jj]
from = min(gg1, gg2)
to = max(gg1, gg2)
rec =  sub_table[which(sub_table$from==from & sub_table$to ==to),]
if (nrow(rec) != 1){
print("ERROR")
next
}
h = rec$weight
if (rec$qValue< 0.05) {col=col=rgb(240,46,46,alpha=100,max=255)} else {col=col=rgb(50,50,50,alpha=50,max=255)}
segments(xx.s[ii],yy.s[ii],xx.s[jj],yy.s[jj],lwd=h,col=col)
}
}
for (count in 1:6){
draw.circle(xx.s[count],yy.s[count],2,col = Ig.cols[count])
}
#text(xx.s,yy.s,gg.list,font=2)
}
debugSource('C:/Users/Meng/Desktop/nCov/bCellfNet/drawNe_libo.R')
debugSource('C:/Users/Meng/Desktop/nCov/bCellfNet/drawNe_libo.R')
debugSource('C:/Users/Meng/Desktop/nCov/bCellfNet/drawNe_libo.R')
debugSource('C:/Users/Meng/Desktop/nCov/bCellfNet/drawNe_libo.R')
rec
setwd("C:/Users/Meng/Desktop/nCov/bCellfNet/")
data = read.csv("./outs/cs_network.csv")
library(plotrix)
data$weight = log2(data$weight+1)
Ig.cols = c("#E64B35", "#4DBBD5", "#00A087", "#3C5488", "#F39B7F", "#8491B4")
samples_without_bacterial = c("S4","S7","S12","S14","S16")
samples_with_bacterial = setdiff(as.vector(unique(data$sample)),c("S4","S7","S12","S14","S16"))
samples_orderd = c(samples_with_bacterial,samples_without_bacterial)
gg.list=c('IGHG1', 'IGHA1', 'IGHM', 'IGHG3', 'IGHG2','IGHA2')
# 六个点的横纵坐标
xx.s = c(-2.5,2.5,5,2.5,-2.5,-5)
yy.s = c(4.33,4.33,0,-4.33,-4.33,0)
cc.list = samples_orderd
par(mar=c(0,0,2,0),mfrow=c(3,5))
for(cc in cc.list){
# tmp.CW.mat=CW.mat[which(cancer.types[rownames(CW.mat)]==cc),]
plot(0,0,xlim=c(-6,6),ylim=c(-6,6),axes=F,xlab='',ylab='',cex=0,asp=1,main=cc,cex.main=1.5)
rr.s=c()
sub_table = subset(data, sample == cc)
for(ii in 1:length(gg.list)){
gg1=gg.list[ii] #获得了这个IGHC
# n.gg1=length(which(tmp.CW.mat[,gg1]==1))/10
# rr.s=c(rr.s,log10(n.gg1))
for(jj in ii:length(gg.list)){
if(jj==ii)next
gg2=gg.list[jj]
from = min(gg1, gg2)
to = max(gg1, gg2)
rec =  sub_table[which(sub_table$from==from & sub_table$to ==to),]
if (nrow(rec) != 1){
print("ERROR")
next
}
h = rec$weight
if (rec$qValue< 0.05) {col=rgb(240,46,46,alpha=150,max=255)} else {col=rgb(50,50,50,alpha=50,max=255)}
segments(xx.s[ii],yy.s[ii],xx.s[jj],yy.s[jj],lwd=h,col=col)
}
}
for (count in 1:6){
draw.circle(xx.s[count],yy.s[count],2,col = Ig.cols[count])
}
#text(xx.s,yy.s,gg.list,font=2)
}
debugSource('C:/Users/Meng/Desktop/nCov/bCellfNet/drawNe_libo.R')
setwd("C:/Users/Meng/Desktop/nCov/bCellfNet/")
data = read.csv("./outs/cs_network.csv")
library(plotrix)
data$weight = log2(data$weight+1)
Ig.cols = c("#E64B35", "#4DBBD5", "#00A087", "#3C5488", "#F39B7F", "#8491B4")
samples_without_bacterial = c("S4","S7","S12","S14","S16")
samples_with_bacterial = setdiff(as.vector(unique(data$sample)),c("S4","S7","S12","S14","S16"))
samples_orderd = c(samples_with_bacterial,samples_without_bacterial)
gg.list=c('IGHG1', 'IGHA1', 'IGHM', 'IGHG3', 'IGHG2','IGHA2')
# 六个点的横纵坐标
xx.s = c(-2.5,2.5,5,2.5,-2.5,-5)
yy.s = c(4.33,4.33,0,-4.33,-4.33,0)
cc.list = samples_orderd
par(mar=c(0,0,2,0),mfrow=c(3,5))
for(cc in cc.list){
# tmp.CW.mat=CW.mat[which(cancer.types[rownames(CW.mat)]==cc),]
plot(0,0,xlim=c(-6,6),ylim=c(-6,6),axes=F,xlab='',ylab='',cex=0,asp=1,main=cc,cex.main=1.5)
rr.s=c()
sub_table = subset(data, sample == cc)
for(ii in 1:length(gg.list)){
gg1=gg.list[ii] #获得了这个IGHC
# n.gg1=length(which(tmp.CW.mat[,gg1]==1))/10
# rr.s=c(rr.s,log10(n.gg1))
for(jj in ii:length(gg.list)){
if(jj==ii)next
gg2=gg.list[jj]
from = min(gg1, gg2)
to = max(gg1, gg2)
rec =  sub_table[which(sub_table$from==from & sub_table$to ==to),]
if (nrow(rec) != 1){
print("ERROR")
next
}
h = rec$weight
if (rec$qValue< 0.05) {col=rgb(240,46,46,alpha=150,max=255)} else {col=rgb(50,50,50,alpha=50,max=255)}
segments(xx.s[ii],yy.s[ii],xx.s[jj],yy.s[jj],lwd=h*2,col=col)
}
}
for (count in 1:6){
draw.circle(xx.s[count],yy.s[count],1.5,col = Ig.cols[count])
}
#text(xx.s,yy.s,gg.list,font=2)
}
debugSource('C:/Users/Meng/Desktop/nCov/bCellfNet/drawNe_libo.R')
setwd("C:/Users/Meng/Desktop/nCov/bCellfNet/")
data = read.csv("./outs/cs_network.csv")
library(plotrix)
data$weight = log2(data$weight+1)
Ig.cols = c("#E64B35", "#4DBBD5", "#00A087", "#3C5488", "#F39B7F", "#8491B4")
samples_without_bacterial = c("S4","S7","S12","S14","S16")
samples_with_bacterial = setdiff(as.vector(unique(data$sample)),c("S4","S7","S12","S14","S16"))
samples_orderd = c(samples_with_bacterial,samples_without_bacterial)
gg.list=c('IGHG1', 'IGHA1', 'IGHM', 'IGHG3', 'IGHG2','IGHA2')
# 六个点的横纵坐标
xx.s = c(-2.5,2.5,5,2.5,-2.5,-5)
yy.s = c(4.33,4.33,0,-4.33,-4.33,0)
cc.list = samples_orderd
par(mar=c(0,0,2,0),mfrow=c(3,5))
for(cc in cc.list){
# tmp.CW.mat=CW.mat[which(cancer.types[rownames(CW.mat)]==cc),]
plot(0,0,xlim=c(-6,6),ylim=c(-6,6),axes=F,xlab='',ylab='',cex=0,asp=1,main=cc,cex.main=1.5)
rr.s=c()
sub_table = subset(data, sample == cc)
for(ii in 1:length(gg.list)){
gg1=gg.list[ii] #获得了这个IGHC
# n.gg1=length(which(tmp.CW.mat[,gg1]==1))/10
# rr.s=c(rr.s,log10(n.gg1))
for(jj in ii:length(gg.list)){
if(jj==ii)next
gg2=gg.list[jj]
from = min(gg1, gg2)
to = max(gg1, gg2)
rec =  sub_table[which(sub_table$from==from & sub_table$to ==to),]
if (nrow(rec) != 1){
print("ERROR")
next
}
h = rec$weight
if (rec$qValue< 0.05) {col=rgb(50,50,50,alpha=100,max=255)} else {col=rgb(50,50,50,alpha=50,max=255)}
segments(xx.s[ii],yy.s[ii],xx.s[jj],yy.s[jj],lwd=h*2,col=col)
}
}
for (count in 1:6){
draw.circle(xx.s[count],yy.s[count],1.5,col = Ig.cols[count])
}
#text(xx.s,yy.s,gg.list,font=2)
}
setwd("C:/Users/Meng/Desktop/nCov/bCellfNet/")
data = read.csv("./outs/cs_network.csv")
library(plotrix)
data$weight = log2(data$weight+1)
Ig.cols = c("#E64B35", "#4DBBD5", "#00A087", "#3C5488", "#F39B7F", "#8491B4")
samples_without_bacterial = c("S4","S7","S12","S14","S16")
samples_with_bacterial = setdiff(as.vector(unique(data$sample)),c("S4","S7","S12","S14","S16"))
samples_orderd = c(samples_with_bacterial,samples_without_bacterial)
gg.list=c('IGHG1', 'IGHA1', 'IGHM', 'IGHG3', 'IGHG2','IGHA2')
# 六个点的横纵坐标
xx.s = c(-2.5,2.5,5,2.5,-2.5,-5)
yy.s = c(4.33,4.33,0,-4.33,-4.33,0)
cc.list = samples_orderd
par(mar=c(0,0,2,0),mfrow=c(3,5))
for(cc in cc.list){
# tmp.CW.mat=CW.mat[which(cancer.types[rownames(CW.mat)]==cc),]
plot(0,0,xlim=c(-6,6),ylim=c(-6,6),axes=F,xlab='',ylab='',cex=0,asp=1,main=cc,cex.main=1.5)
rr.s=c()
sub_table = subset(data, sample == cc)
for(ii in 1:length(gg.list)){
gg1=gg.list[ii] #获得了这个IGHC
# n.gg1=length(which(tmp.CW.mat[,gg1]==1))/10
# rr.s=c(rr.s,log10(n.gg1))
for(jj in ii:length(gg.list)){
if(jj==ii)next
gg2=gg.list[jj]
from = min(gg1, gg2)
to = max(gg1, gg2)
rec =  sub_table[which(sub_table$from==from & sub_table$to ==to),]
if (nrow(rec) != 1){
print("ERROR")
next
}
h = rec$weight
if (rec$qValue< 0.05) {col=rgb(50,50,50,max=255)} else {col=rgb(50,50,50,alpha=50,max=255)}
segments(xx.s[ii],yy.s[ii],xx.s[jj],yy.s[jj],lwd=h*2,col=col)
}
}
for (count in 1:6){
draw.circle(xx.s[count],yy.s[count],1.5,col = Ig.cols[count])
}
#text(xx.s,yy.s,gg.list,font=2)
}
debugSource('C:/Users/Meng/Desktop/nCov/bCellfNet/drawNe_libo.R')
setwd("C:/Users/Meng/Desktop/nCov/bCellfNet/")
data = read.csv("./outs/cs_network.csv")
library(plotrix)
data$weight = log2(data$weight+1)
Ig.cols = c("#E64B35", "#4DBBD5", "#00A087", "#3C5488", "#F39B7F", "#8491B4")
samples_without_bacterial = c("S4","S7","S12","S14","S16")
samples_with_bacterial = setdiff(as.vector(unique(data$sample)),c("S4","S7","S12","S14","S16"))
samples_orderd = c(samples_with_bacterial,samples_without_bacterial)
gg.list=c('IGHG1', 'IGHA1', 'IGHM', 'IGHG3', 'IGHG2','IGHA2')
# 六个点的横纵坐标
xx.s = c(-2.5,2.5,5,2.5,-2.5,-5)
yy.s = c(4.33,4.33,0,-4.33,-4.33,0)
cc.list = samples_orderd
par(mar=c(0,0,2,0),mfrow=c(3,5))
for(cc in cc.list){
# tmp.CW.mat=CW.mat[which(cancer.types[rownames(CW.mat)]==cc),]
plot(0,0,xlim=c(-6,6),ylim=c(-6,6),axes=F,xlab='',ylab='',cex=0,asp=1,main=cc,cex.main=1.5)
rr.s=c()
sub_table = subset(data, sample == cc)
for(ii in 1:length(gg.list)){
gg1=gg.list[ii] #获得了这个IGHC
# n.gg1=length(which(tmp.CW.mat[,gg1]==1))/10
# rr.s=c(rr.s,log10(n.gg1))
for(jj in ii:length(gg.list)){
if(jj==ii)next
gg2=gg.list[jj]
from = min(gg1, gg2)
to = max(gg1, gg2)
rec =  sub_table[which(sub_table$from==from & sub_table$to ==to),]
if (nrow(rec) != 1){
print("ERROR")
next
}
h = rec$weight
if (rec$qValue< 0.05) {col=rgb(50,50,50,alpha=180,max=255)} else {col=rgb(50,50,50,alpha=100,max=255)}
segments(xx.s[ii],yy.s[ii],xx.s[jj],yy.s[jj],lwd=h*2,col=col)
}
}
for (count in 1:6){
draw.circle(xx.s[count],yy.s[count],1.5,col = Ig.cols[count])
}
#text(xx.s,yy.s,gg.list,font=2)
}
setwd("C:/Users/Meng/Desktop/nCov/bCellfNet/")
data = read.csv("./outs/cs_network.csv")
library(plotrix)
data$weight = log2(data$weight+1)
Ig.cols = c("#E64B35", "#4DBBD5", "#00A087", "#3C5488", "#F39B7F", "#8491B4")
samples_without_bacterial = c("S4","S7","S12","S14","S16")
samples_with_bacterial = setdiff(as.vector(unique(data$sample)),c("S4","S7","S12","S14","S16"))
samples_orderd = c(samples_with_bacterial,samples_without_bacterial)
gg.list=c('IGHG1', 'IGHA1', 'IGHM', 'IGHG3', 'IGHG2','IGHA2')
# 六个点的横纵坐标
xx.s = c(-2.5,2.5,5,2.5,-2.5,-5)
yy.s = c(4.33,4.33,0,-4.33,-4.33,0)
cc.list = samples_orderd
par(mar=c(0,0,2,0),mfrow=c(3,5))
for(cc in cc.list){
# tmp.CW.mat=CW.mat[which(cancer.types[rownames(CW.mat)]==cc),]
plot(0,0,xlim=c(-6,6),ylim=c(-6,6),axes=F,xlab='',ylab='',cex=0,asp=1,main=cc,cex.main=1.5)
rr.s=c()
sub_table = subset(data, sample == cc)
for(ii in 1:length(gg.list)){
gg1=gg.list[ii] #获得了这个IGHC
# n.gg1=length(which(tmp.CW.mat[,gg1]==1))/10
# rr.s=c(rr.s,log10(n.gg1))
for(jj in ii:length(gg.list)){
if(jj==ii)next
gg2=gg.list[jj]
from = min(gg1, gg2)
to = max(gg1, gg2)
rec =  sub_table[which(sub_table$from==from & sub_table$to ==to),]
if (nrow(rec) != 1){
print("ERROR")
next
}
h = rec$weight
if (rec$qValue< 0.05) {col=rgb(50,50,50,alpha=180,max=255)} else {col=rgb(50,50,50,alpha=100,max=255)}
segments(xx.s[ii],yy.s[ii],xx.s[jj],yy.s[jj],lwd=h*2,col=col)
}
}
for (count in 1:6){
draw.circle(xx.s[count],yy.s[count],1.3,col = Ig.cols[count])
}
#text(xx.s,yy.s,gg.list,font=2)
}
plot(0,0,xlim=c(-6,6),ylim=c(-6,6),axes=F,xlab='',ylab='',cex=0,asp=1,cex.main=1.5)
draw.circle(x=c(-4,-4,-4),y=c(1,3,5)-0.5,radius=log10(c(20,50,100)/10),col='gray',border=NA)
c(-4,-4,-4)[1]
c(-4,-4,-4)[2]
setwd("C:/Users/Meng/Desktop/nCov/bCellfNet/")
data = read.csv("./outs/cs_network.csv")
library(plotrix)
data$weight = log2(data$weight+1)
Ig.cols = c("#E64B35", "#4DBBD5", "#00A087", "#3C5488", "#F39B7F", "#8491B4")
samples_without_bacterial = c("S4","S7","S12","S14","S16")
samples_with_bacterial = setdiff(as.vector(unique(data$sample)),c("S4","S7","S12","S14","S16"))
samples_orderd = c(samples_with_bacterial,samples_without_bacterial)
gg.list=c('IGHG1', 'IGHA1', 'IGHM', 'IGHG3', 'IGHG2','IGHA2')
# 六个点的横纵坐标
xx.s = c(-2.5,2.5,5,2.5,-2.5,-5)
yy.s = c(4.33,4.33,0,-4.33,-4.33,0)
cc.list = samples_orderd
par(mar=c(0,0,2,0),mfrow=c(3,5))
for(cc in cc.list){
# tmp.CW.mat=CW.mat[which(cancer.types[rownames(CW.mat)]==cc),]
plot(0,0,xlim=c(-6,6),ylim=c(-6,6),axes=F,xlab='',ylab='',cex=0,asp=1,main=cc,cex.main=1.5)
rr.s=c()
sub_table = subset(data, sample == cc)
for(ii in 1:length(gg.list)){
gg1=gg.list[ii] #获得了这个IGHC
# n.gg1=length(which(tmp.CW.mat[,gg1]==1))/10
# rr.s=c(rr.s,log10(n.gg1))
for(jj in ii:length(gg.list)){
if(jj==ii)next
gg2=gg.list[jj]
from = min(gg1, gg2)
to = max(gg1, gg2)
rec =  sub_table[which(sub_table$from==from & sub_table$to ==to),]
if (nrow(rec) != 1){
print("ERROR")
next
}
h = rec$weight
if (rec$qValue< 0.05) {col=rgb(50,50,50,alpha=180,max=255)} else {col=rgb(50,50,50,alpha=100,max=255)}
segments(xx.s[ii],yy.s[ii],xx.s[jj],yy.s[jj],lwd=h*2,col=col)
}
}
setwd("C:/Users/Meng/Desktop/nCov/bCellfNet/")
data = read.csv("./outs/cs_network.csv")
library(plotrix)
data$weight = log2(data$weight+1)
Ig.cols = c("#E64B35", "#4DBBD5", "#00A087", "#3C5488", "#F39B7F", "#8491B4")
samples_without_bacterial = c("S4","S7","S12","S14","S16")
samples_with_bacterial = setdiff(as.vector(unique(data$sample)),c("S4","S7","S12","S14","S16"))
samples_orderd = c(samples_with_bacterial,samples_without_bacterial)
gg.list=c('IGHG1', 'IGHA1', 'IGHM', 'IGHG3', 'IGHG2','IGHA2')
# 六个点的横纵坐标
xx.s = c(-2.5,2.5,5,2.5,-2.5,-5)
yy.s = c(4.33,4.33,0,-4.33,-4.33,0)
cc.list = samples_orderd
par(mar=c(0,0,2,0),mfrow=c(3,5))
for(cc in cc.list){
# tmp.CW.mat=CW.mat[which(cancer.types[rownames(CW.mat)]==cc),]
plot(0,0,xlim=c(-6,6),ylim=c(-6,6),axes=F,xlab='',ylab='',cex=0,asp=1,main=cc,cex.main=1.5)
rr.s=c()
sub_table = subset(data, sample == cc)
for(ii in 1:length(gg.list)){
gg1=gg.list[ii] #获得了这个IGHC
# n.gg1=length(which(tmp.CW.mat[,gg1]==1))/10
# rr.s=c(rr.s,log10(n.gg1))
for(jj in ii:length(gg.list)){
if(jj==ii)next
gg2=gg.list[jj]
from = min(gg1, gg2)
to = max(gg1, gg2)
rec =  sub_table[which(sub_table$from==from & sub_table$to ==to),]
if (nrow(rec) != 1){
print("ERROR")
next
}
h = rec$weight
if (rec$qValue< 0.05) {col=rgb(50,50,50,alpha=180,max=255)} else {col=rgb(50,50,50,alpha=100,max=255)}
segments(xx.s[ii],yy.s[ii],xx.s[jj],yy.s[jj],lwd=h*2,col=col)
}
}
for (count in 1:6){
draw.circle(xx.s[count],yy.s[count],1.3,col = Ig.cols[count])
}
#text(xx.s,yy.s,gg.list,font=2)
}
setwd("C:/Users/Meng/Desktop/nCov/bCellfNet/")
data = read.csv("./outs/cs_network.csv")
library(plotrix)
data$weight = log2(data$weight+1)
Ig.cols = c("#E64B35", "#4DBBD5", "#00A087", "#3C5488", "#F39B7F", "#8491B4")
samples_without_bacterial = c("S4","S7","S12","S14","S16")
samples_with_bacterial = setdiff(as.vector(unique(data$sample)),c("S4","S7","S12","S14","S16"))
samples_orderd = c(samples_with_bacterial,samples_without_bacterial)
gg.list=c('IGHG1', 'IGHA1', 'IGHM', 'IGHG3', 'IGHG2','IGHA2')
# 六个点的横纵坐标
xx.s = c(-2.5,2.5,5,2.5,-2.5,-5)
yy.s = c(4.33,4.33,0,-4.33,-4.33,0)
cc.list = samples_orderd
par(mar=c(0,0,2,0),mfrow=c(3,5))
for(cc in cc.list){
# tmp.CW.mat=CW.mat[which(cancer.types[rownames(CW.mat)]==cc),]
plot(0,0,xlim=c(-6,6),ylim=c(-6,6),axes=F,xlab='',ylab='',cex=0,asp=1,main=cc,cex.main=1.5)
rr.s=c()
sub_table = subset(data, sample == cc)
for(ii in 1:length(gg.list)){
gg1=gg.list[ii] #获得了这个IGHC
# n.gg1=length(which(tmp.CW.mat[,gg1]==1))/10
# rr.s=c(rr.s,log10(n.gg1))
for(jj in ii:length(gg.list)){
if(jj==ii)next
gg2=gg.list[jj]
from = min(gg1, gg2)
to = max(gg1, gg2)
rec =  sub_table[which(sub_table$from==from & sub_table$to ==to),]
if (nrow(rec) != 1){
print("ERROR")
next
}
h = rec$weight
if (rec$qValue< 0.05) {col=rgb(50,50,50,alpha=180,max=255)} else {col=rgb(50,50,50,alpha=100,max=255)}
segments(xx.s[ii],yy.s[ii],xx.s[jj],yy.s[jj],lwd=h*2,col=col)
}
}
for (count in 1:6){
draw.circle(xx.s[count],yy.s[count],1.3,col = Ig.cols[count])
}
#text(xx.s,yy.s,gg.list,font=2)
}
setwd("C:/Users/Meng/Desktop/nCov/bCellfNet/")
data = read.csv("./outs/cs_network.csv")
library(plotrix)
data$weight = log2(data$weight+1)
Ig.cols = c("#E64B35", "#4DBBD5", "#00A087", "#3C5488", "#F39B7F", "#8491B4")
samples_without_bacterial = c("S4","S7","S12","S14","S16")
samples_with_bacterial = setdiff(as.vector(unique(data$sample)),c("S4","S7","S12","S14","S16"))
samples_orderd = c(samples_with_bacterial,samples_without_bacterial)
gg.list=c('IGHG1', 'IGHA1', 'IGHM', 'IGHG3', 'IGHG2','IGHA2')
# 六个点的横纵坐标
xx.s = c(-2.5,2.5,5,2.5,-2.5,-5)
yy.s = c(4.33,4.33,0,-4.33,-4.33,0)
cc.list = samples_orderd
par(mar=c(0,0,2,0),mfrow=c(3,5))
for(cc in cc.list){
# tmp.CW.mat=CW.mat[which(cancer.types[rownames(CW.mat)]==cc),]
plot(0,0,xlim=c(-6,6),ylim=c(-6,6),axes=F,xlab='',ylab='',cex=0,asp=1,main=cc,cex.main=1.5)
rr.s=c()
sub_table = subset(data, sample == cc)
for(ii in 1:length(gg.list)){
gg1=gg.list[ii] #获得了这个IGHC
# n.gg1=length(which(tmp.CW.mat[,gg1]==1))/10
# rr.s=c(rr.s,log10(n.gg1))
for(jj in ii:length(gg.list)){
if(jj==ii)next
gg2=gg.list[jj]
from = min(gg1, gg2)
to = max(gg1, gg2)
rec =  sub_table[which(sub_table$from==from & sub_table$to ==to),]
if (nrow(rec) != 1){
print("ERROR")
next
}
h = rec$weight
if (rec$qValue< 0.05) {col=rgb(50,50,50,alpha=180,max=255)} else {col=rgb(50,50,50,alpha=100,max=255)}
segments(xx.s[ii],yy.s[ii],xx.s[jj],yy.s[jj],lwd=h*2,col=col)
}
}
for (count in 1:6){
draw.circle(xx.s[count],yy.s[count],1.3,col = Ig.cols[count])
}
#text(xx.s,yy.s,gg.list,font=2)
}
